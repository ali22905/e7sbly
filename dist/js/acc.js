"use strict";var __awaiter=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(l,i){function s(e){try{d(n.next(e))}catch(t){i(t)}}function r(e){try{d(n.throw(e))}catch(t){i(t)}}function d(e){var t;e.done?l(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(s,r)}d((n=n.apply(e,t||[])).next())})};let all_data=document.getElementById("data");const game_name=document.getElementById("game_name"),game_price=document.getElementById("game_price"),save_btn=document.getElementById("save_btn"),reset_btn=document.getElementById("reset_btn"),plus_btn=document.getElementById("plus_btn"),delete_inp_btns=document.querySelectorAll(".delete-inp");plus_btn.addEventListener("click",()=>{let e=0,t=document.createElement("div");t.classList.add("row");let a=document.createElement("input");a.setAttribute("type","text"),a.setAttribute("placeholder","game name"),a.setAttribute("data-n-code",`${e}`),a.setAttribute("name","game"),a.classList.add("set-name");let n=document.createElement("span"),l=document.createTextNode("--");n.append(l),n.classList.add("delete-inp");let i=document.createElement("input");i.setAttribute("type","number"),i.setAttribute("placeholder","price/hour"),i.setAttribute("data-p-code",`${e}`),i.setAttribute("name","price"),i.classList.add("set-price"),t.appendChild(a),t.appendChild(n),t.appendChild(i),e++,document.querySelector("section.games-settings .set-games").appendChild(t),n.addEventListener("click",()=>{n.parentNode.remove()})}),save_btn.addEventListener("click",e=>{let t=document.querySelectorAll(".set-name"),a=document.querySelectorAll(".set-price"),n=!0,l=!0;t.forEach(e=>{""==e.value?(n=!1,document.getElementById("invalid_name").classList.remove("d-none")):(n=!0,document.getElementById("invalid_name").classList.add("d-none"))}),a.forEach(e=>{""==e.value?(l=!1,document.getElementById("invalid_price").classList.remove("d-none")):(l=!0,document.getElementById("invalid_price").classList.add("d-none"))}),!0==n&&!0==l||e.preventDefault()}),document.getElementById("user_name").value=localStorage.getItem("user_name");const add_to_cart=e=>__awaiter(void 0,void 0,void 0,function*(){try{let t=yield fetch(e,{method:"POST"}),a=yield t.json();console.log(a),window.location.href="/home",console.log(a)}catch(n){console.log(n)}});fetch("/",{method:"POST"}).then(e=>e.json()).then(e=>{console.log(e),window.location.href="/login"});let user_name_link=document.getElementById("reset_btn").getAttribute("data-link");document.getElementById("reset_btn").addEventListener("click",()=>{reset_req(`/home/${user_name_link}`)});const reset_req=e=>__awaiter(void 0,void 0,void 0,function*(){try{let t=yield fetch(e,{method:"PUT"}),a=yield t.json();console.log(a),window.location.href=`/home/${user_name_link}`}catch(n){console.log(`myError from the delete request :  ${n}`)}});let add_game_btn=document.getElementById("add_game_btn");add_game_btn.addEventListener("click",()=>{let e=document.getElementById("play_game_card"),t=e.cloneNode(!0);e.after(t);let a=document.querySelectorAll(".delete_set_game");console.log(a),a.forEach(e=>{e.addEventListener("click",()=>{e.parentNode.parentNode.parentNode.remove()})})});let start_time_inp=document.querySelectorAll(".start_clock");function update_start_time(e){e.value=new Date().toLocaleTimeString()}start_time_inp.forEach(e=>{update_start_time(e),setInterval(function(){update_start_time(e)},6e4)});let start_btns=document.querySelectorAll(".start_play_game"),game_price_inp=document.getElementById("game_price_inp"),timeRegex=/(\d{2}|\d{1}):\d{2}:\d{2}\s(PM|AM)/g,start_play_game=document.getElementById("start_play_game"),prices=all_data.getAttribute("data-prices").split(","),games=all_data.getAttribute("data-games").split(",");start_play_game.addEventListener("click",e=>{let t=document.querySelectorAll(".playing_game"),a=document.querySelectorAll(".game_price_inp");for(let n=0;n<t.length;n++){let l=prices[games.indexOf(t[n].options[t[n].selectedIndex].text)];a[n].value=l}});let delete_client_btns=document.querySelectorAll(".delete_play_game"),user_id=all_data.getAttribute("data-id"),chosen_games=all_data.getAttribute("data-chosen_game").split(","),chosen_game_prices=all_data.getAttribute("data-chosen_game_price").split(","),clients_names=all_data.getAttribute("data-client_name").split(","),start_times=all_data.getAttribute("data-start_time").split(",");delete_client_btns.forEach(e=>{e.addEventListener("click",()=>{let t=parseInt(e.getAttribute("data-index"));chosen_games.splice(t,1),chosen_game_prices.splice(t,1),clients_names.splice(t,1),start_times.splice(t,1);delete_client(`/acc/${user_id}`,{chosen_game:chosen_games,chosen_game_price:chosen_game_prices,client_name:clients_names,start_time:start_times,index:t})})});const delete_client=(e,t)=>{fetch(e,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{window.location.href=`/home/${e.user_name}`})};